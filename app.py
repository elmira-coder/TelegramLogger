# app.py
"""
Запуск генератора случайных ошибок для демонстрации работы логгера.

Файл:
- Постоянно работает в цикле.
- Периодически генерирует ошибки разных типов.
- Логирует ошибки в файл и отправляет уведомления в Telegram через настроенный логгер.
"""

import time
import random
from logger_setup import setup_logger
from error_generator import generate_error

# Настройка логгера (запись в файл + Telegram)
logger = setup_logger()

logger.info("Приложение запущено и работает постоянно")

# Бесконечный цикл работы приложения
while True:
    try:
        # Случайная пауза между итерациями (от 5 до 120 секунд)
        time.sleep(random.randint(5, 120))

        # Случайно решаем: генерировать ошибку или просто логировать итерацию
        if random.random() < 0.6:
            generate_error()  # Генерация случайной ошибки
        else:
            logger.info("Очередная итерация без ошибок")  # Просто логируем обычное сообщение

    except Exception:
        # Если произошла ошибка, логируем её полностью со стек-трейсом
        logger.exception("Автоматически сгенерированная ошибка")
